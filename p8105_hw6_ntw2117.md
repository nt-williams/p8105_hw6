Data Science Homework 6
================

### Problem One

*importing and manipulating data*

``` r
murder <- 
  read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   uid = col_character(),
    ##   reported_date = col_integer(),
    ##   victim_last = col_character(),
    ##   victim_first = col_character(),
    ##   victim_race = col_character(),
    ##   victim_age = col_character(),
    ##   victim_sex = col_character(),
    ##   city = col_character(),
    ##   state = col_character(),
    ##   lat = col_double(),
    ##   lon = col_double(),
    ##   disposition = col_character()
    ## )

``` r
murder <- murder %>%  
  unite("city_state", c("city", "state"), sep = ", ") %>% 
  mutate(solved = ifelse(disposition == "Closed by arrest", 1, 0), 
         victim_race = ifelse(victim_race != "White", "non-White", "White"), 
         victim_race = fct_relevel(victim_race, "White", "non-White"),
         victim_age = as.numeric(victim_age)) %>% 
  filter(!(city_state %in% c("Dallas, TX", "Phoenix, AZ", "Kansas City, MO", "Tulsa, AL")))
```

    ## Warning in evalq(as.numeric(victim_age), <environment>): NAs introduced by
    ## coercion

*some wee models*

``` r
balt_model <- murder %>% 
  filter(city_state == "Baltimore, MD") %>% 
  glm(solved ~ victim_sex + victim_race + victim_age, family = binomial, data = .)

broom::tidy(balt_model) %>% 
  mutate(or = exp(estimate), 
         or_lower = exp(estimate - 1.96*std.error), 
         or_upper = exp(estimate + 1.96*std.error)) %>% 
  filter(term == "victim_racenon-White") %>% 
  select(or, or_lower, or_upper) %>% 
  rename("Odds ratio" = or, 
         "Lower bound" = or_lower, 
         "Upper bound" = or_upper) %>% 
  knitr::kable(digits = 3)
```

|  Odds ratio|  Lower bound|  Upper bound|
|-----------:|------------:|------------:|
|       0.441|        0.313|         0.62|

``` r
murder %>% 
  group_by(city_state) %>% 
  nest() %>% 
  mutate(logit_solve = map(data, ~glm(solved ~ victim_sex + victim_race + victim_age, family = binomial, data = .x)))
```

    ## # A tibble: 47 x 3
    ##    city_state      data                  logit_solve
    ##    <chr>           <list>                <list>     
    ##  1 Albuquerque, NM <tibble [378 x 11]>   <S3: glm>  
    ##  2 Atlanta, GA     <tibble [973 x 11]>   <S3: glm>  
    ##  3 Baltimore, MD   <tibble [2,827 x 11]> <S3: glm>  
    ##  4 Baton Rouge, LA <tibble [424 x 11]>   <S3: glm>  
    ##  5 Birmingham, AL  <tibble [800 x 11]>   <S3: glm>  
    ##  6 Boston, MA      <tibble [614 x 11]>   <S3: glm>  
    ##  7 Buffalo, NY     <tibble [521 x 11]>   <S3: glm>  
    ##  8 Charlotte, NC   <tibble [687 x 11]>   <S3: glm>  
    ##  9 Chicago, IL     <tibble [5,535 x 11]> <S3: glm>  
    ## 10 Cincinnati, OH  <tibble [694 x 11]>   <S3: glm>  
    ## # ... with 37 more rows
